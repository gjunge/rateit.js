(function(c){function r(d){var c=d.originalEvent.changedTouches[0],k="";switch(d.type){case "touchmove":k="mousemove";break;case "touchend":k="mouseup";break;default:return}var g=document.createEvent("MouseEvent");g.initMouseEvent(k,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null);c.target.dispatchEvent(g);d.preventDefault()}c.rateit={aria:{resetLabel:"reset rating",ratingLabel:"rating"}};c.fn.rateit=function(d,h){var k=1,g={},n="init";if(0==this.length)return this;var j=
c.type(d);if("object"==j||void 0===d||null==d)g=c.extend({},c.fn.rateit.defaults,d);else{if("string"==j&&void 0===h)return this.data("rateit"+(d.charAt(0).toUpperCase()+d.substr(1)));"string"==j&&(n="setvalue")}return this.each(function(){var e=c(this),a=function(a,b){if(null!=b){var c="aria-value"+("value"==a?"now":a),f=e.find(".rateit-range");void 0!=f.attr(c)&&f.attr(c,b)}arguments[0]="rateit"+(a.charAt(0).toUpperCase()+a.substr(1));return e.data.apply(e,arguments)};e.hasClass("rateit")||e.addClass("rateit");
var l="rtl"!=e.css("direction");if("setvalue"==n){if(!a("init"))throw"Can't set value before init";"readonly"==d&&(!0==h&&!a("readonly"))&&(e.find(".rateit-range").unbind(),a("wired",!1));"value"==d&&null==h&&(h=a("min"));if(a("backingfld")){var b=c(a("backingfld"));"value"==d&&b.val(h);"min"==d&&b[0].min&&(b[0].min=h);"max"==d&&b[0].max&&(b[0].max=h);"step"==d&&b[0].step&&(b[0].step=h)}a(d,h)}if(!a("init")){a("min",a("min")||g.min);a("max",a("max")||g.max);a("step",a("step")||g.step);a("readonly",
void 0!==a("readonly")?a("readonly"):g.readonly);a("resetable",void 0!==a("resetable")?a("resetable"):g.resetable);a("backingfld",a("backingfld")||g.backingfld);a("starwidth",a("starwidth")||g.starwidth);a("starheight",a("starheight")||g.starheight);a("value",a("value")||g.value||g.min);a("ispreset",void 0!==a("ispreset")?a("ispreset"):g.ispreset);if(a("backingfld")){b=c(a("backingfld"));a("value",b.hide().val());(b.attr("disabled")||b.attr("readonly"))&&a("readonly",!0);if("INPUT"==b[0].nodeName&&
("range"==b[0].type||"text"==b[0].type))a("min",parseInt(b.attr("min"))||a("min")),a("max",parseInt(b.attr("max"))||a("max")),a("step",parseInt(b.attr("step"))||a("step"));"SELECT"==b[0].nodeName&&1<b[0].options.length&&(a("min",Number(b[0].options[0].value)),a("max",Number(b[0].options[b[0].length-1].value)),a("step",Number(b[0].options[1].value)-Number(b[0].options[0].value)))}k++;b='<div id="rateit-reset-{{index}}" class="rateit-reset" role="button" aria-label="'+c.rateit.aria.resetLabel+'" aria-controls="rateit-range-{{index}}" tabindex="0"></div><div id="rateit-range-{{index}}" class="rateit-range" tabindex="0" role="slider" aria-label="'+
c.rateit.aria.ratingLabel+'" aria-owns="rateit-reset-{{index}}" aria-valuemin="'+a("min")+'" aria-valuemax="'+a("max")+'" aria-valuenow="'+a("value")+'"><div class="rateit-selected" style="height:'+a("starheight")+'px"></div><div class="rateit-hover" style="height:'+a("starheight")+'px"></div></div>';e.append(b.replace(/{{index}}/gi,k));l||(e.find(".rateit-reset").css("float","right"),e.find(".rateit-selected").addClass("rateit-selected-rtl"),e.find(".rateit-hover").addClass("rateit-hover-rtl"));
a("init",!0)}var f=e.find(".rateit-range");f.width(a("starwidth")*(a("max")-a("min"))).height(a("starheight"));var j="rateit-preset"+(l?"":"-rtl");a("ispreset")?e.find(".rateit-selected").addClass(j):e.find(".rateit-selected").removeClass(j);if(null!=a("value")){var p=(a("value")-a("min"))*a("starwidth");e.find(".rateit-selected").width(p)}b=e.find(".rateit-reset");!0!==b.data("wired")&&b.bind("click keypress",function(b){"keypress"==b.type&&32!=b.which&&13!=b.which||(b.preventDefault(),a("value",
a("min")),f.find(".rateit-hover").hide().width(0),f.find(".rateit-selected").width(0).show(),a("backingfld")&&c(a("backingfld")).val(a("min")),e.trigger("reset"))}).data("wired",!0);var q=function(b,e){var d=(e.changedTouches?e.changedTouches[0].pageX:e.pageX)-c(b).offset().left;l||(d=f.width()-d);d>f.width()&&(d=f.width());0>d&&(d=0);return p=Math.ceil(d/a("starwidth")*(1/a("step")))},m=function(b){a("value",b);a("backingfld")&&c(a("backingfld")).val(b);a("ispreset")&&(f.find(".rateit-selected").removeClass(j),
a("ispreset",!1));f.find(".rateit-hover").hide();f.find(".rateit-selected").width(b*a("starwidth")-a("min")*a("starwidth")).show();e.trigger("hover",[null]).trigger("over",[null]).trigger("rated",[b])};a("readonly")?b.hide():(a("resetable")||b.hide(),a("wired")||(f.bind("touchmove touchend",r),f.mousemove(function(b){b=q(this,b);var c=b*a("starwidth")*a("step"),d=f.find(".rateit-hover");d.data("width")!=c&&(f.find(".rateit-selected").hide(),d.width(c).show().data("width",c),b=[b*a("step")+a("min")],
e.trigger("hover",b).trigger("over",b))}),f.mouseleave(function(){f.find(".rateit-hover").hide().width(0).data("width","");e.trigger("hover",[null]).trigger("over",[null]);f.find(".rateit-selected").show()}),f.mouseup(function(b){b=q(this,b)*a("step")+a("min");m(b)}),f.keyup(function(b){(38==b.which||b.which==(l?39:37))&&m(Math.min(a("value")+a("step"),a("max")));(40==b.which||b.which==(l?37:39))&&m(Math.max(a("value")-a("step"),a("min")))}),a("wired",!0)),a("resetable")&&b.show());f.attr("aria-readonly",
a("readonly"))})};c.fn.rateit.defaults={min:0,max:5,step:0.5,starwidth:16,starheight:16,readonly:!1,resetable:!0,ispreset:!1};c(function(){c("div.rateit").rateit()})})(jQuery);